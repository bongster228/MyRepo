     1                                 %line 1+1 ast11Re.asm
     2                                 
     3                                 
     4                                 
     5                                 
     6                                 
     7                                 
     8                                 
     9                                 
    10                                 
    11                                 
    12                                 
    13                                 
    14                                 
    15                                 
    16                                 
    17                                 
    18                                 
    19                                 
    20                                 
    21                                 
    22                                 [section .data]
    23                                 
    24                                 
    25                                 
    26                                 
    27                                 LF equ 10
    28                                 NULL equ 0
    29                                 SPACE equ 0x20
    30                                 
    31                                 TRUE equ 1
    32                                 FALSE equ 0
    33                                 
    34                                 EXIT_SUCCESS equ 0
    35                                 EXIT_NOSUCCESS equ 1
    36                                 
    37                                 STDIN equ 0
    38                                 STDOUT equ 1
    39                                 STDERR equ 2
    40                                 
    41                                 SYS_read equ 0
    42                                 SYS_write equ 1
    43                                 SYS_open equ 2
    44                                 SYS_close equ 3
    45                                 SYS_fork equ 57
    46                                 SYS_exit equ 60
    47                                 SYS_creat equ 85
    48                                 SYS_time equ 201
    49                                 
    50                                 O_CREAT equ 0x40
    51                                 O_TRUNC equ 0x200
    52                                 O_APPEND equ 0x400
    53                                 
    54                                 O_RDONLY equ 000000
    55                                 O_WRONLY equ 000001
    56                                 O_RDWR equ 000002
    57                                 
    58                                 S_IRUSR equ 00400
    59                                 S_IWUSR equ 00200
    60                                 S_IXUSR equ 00100
    61                                 
    62                                 
    63                                 
    64                                 
    65 00000000 55736167653A202E2F-    usageMsg db "Usage: ./benford -i <inputFileName> "
    66 00000000 62656E666F7264202D-
    67 00000000 69203C696E70757446-
    68 00000000 696C654E616D653E20 
    69 00000024 2D6F203C6F75747075-     db "-o <outputFileName> -d <T/F>", LF, NULL
    70 00000024 7446696C654E616D65-
    71 00000024 3E202D64203C542F46-
    72 00000024 3E0A00             
    73                                 
    74 00000042 4572726F722C20746F-    errMany db "Error, too many characters on the "
    75 00000042 6F206D616E79206368-
    76 00000042 617261637465727320-
    77 00000042 6F6E2074686520     
    78 00000064 636F6D6D616E64206C-     db "command line.", LF, NULL
    79 00000064 696E652E0A00       
    80                                 
    81 00000073 4572726F722C20746F-    errFew db "Error, too few characters on the "
    82 00000073 6F2066657720636861-
    83 00000073 72616374657273206F-
    84 00000073 6E2074686520       
    85 00000094 636F6D6D616E64206C-     db "command line.", LF, NULL
    86 00000094 696E652E0A00       
    87                                 
    88 000000A3 4572726F722C20696E-    errDSpec db "Error, invalid output display specifier."
    89 000000A3 76616C6964206F7574-
    90 000000A3 70757420646973706C-
    91 000000A3 617920737065636966-
    92 000000A3 6965722E           
    93 000000CB 0A00                    db LF, NULL
    94                                 
    95 000000CD 4572726F722C20696E-    errISpec db "Error, invalid input file specifier."
    96 000000CD 76616C696420696E70-
    97 000000CD 75742066696C652073-
    98 000000CD 70656369666965722E 
    99 000000F1 0A00                    db LF, NULL
   100                                 
   101 000000F3 4572726F722C20696E-    errOSpec db "Error, invalid output file specifier."
   102 000000F3 76616C6964206F7574-
   103 000000F3 7075742066696C6520-
   104 000000F3 737065636966696572-
   105 000000F3 2E                 
   106 00000118 0A00                    db LF, NULL
   107                                 
   108 0000011A 4572726F722C20696E-    errTF db "Error, invalid display option. Must be T or F."
   109 0000011A 76616C696420646973-
   110 0000011A 706C6179206F707469-
   111 0000011A 6F6E2E204D75737420-
   112 0000011A 62652054206F722046-
   113 0000011A 2E                 
   114 00000148 0A00                    db LF, NULL
   115                                 
   116 0000014A 4572726F722C206361-    errOpenIn db "Error, can not open input file."
   117 0000014A 6E206E6F74206F7065-
   118 0000014A 6E20696E7075742066-
   119 0000014A 696C652E           
   120 00000169 0A00                    db LF, NULL
   121                                 
   122 0000016B 4572726F722C206361-    errOpenOut db "Error, can not open output file."
   123 0000016B 6E206E6F74206F7065-
   124 0000016B 6E206F757470757420-
   125 0000016B 66696C652E         
   126 0000018B 0A00                    db LF, NULL
   127                                 
   128 0000018D 0000000000000000       rdFileDescriptor dq 0
   129                                 
   130                                 
   131                                 
   132                                 
   133                                 
   134                                 BUFFSIZE equ 1
   135                                 
   136                                 SKIP_LINES equ 5
   137                                 SKIP_CHARS equ 6
   138                                 
   139 00000195 01                     nextCharIsFirst db TRUE
   140 00000196 00000000               skipLineCount dd 0
   141 0000019A 00000000               skipCharCount dd 0
   142 0000019E 00                     gotDigit db FALSE
   143 0000019F 00                     fDigit db 0
   144 000001A0 00                     chr db 0
   145                                 
   146 000001A1 0100000000000000       bfMax dq BUFFSIZE
   147 000001A9 0100000000000000       curr dq BUFFSIZE
   148                                 
   149 000001B1 00                     wasEOF db FALSE
   150                                 
   151 000001B2 4572726F7220726561-    errFileRead db "Error reading input file."
   152 000001B2 64696E6720696E7075-
   153 000001B2 742066696C652E     
   154 000001CB 50726F6772616D2074-     db "Program terminated."
   155 000001CB 65726D696E61746564-
   156 000001CB 2E                 
   157 000001DE 0A00                    db LF, NULL
   158                                 
   159                                 
   160                                 
   161                                 
   162                                 SCALE1 equ 100
   163                                 SCALE2 equ 1000
   164                                 SCALE3 equ 2500
   165                                 SCALE4 equ 5000
   166                                 
   167 000001E0 64000000               scale dd SCALE1
   168 000001E4 00000000               totalCnt dd 0
   169 000001E8 00000000               currCount dd 0
   170 000001EC 00000000               starCount dd 0
   171                                 
   172 000001F0 03000000               weight dd 3
   173                                 
   174 000001F4 4572726F7220777269-    errFileWrite db "Error writting output file."
   175 000001F4 7474696E67206F7574-
   176 000001F4 7075742066696C652E 
   177 0000020F 0A00                    db LF, NULL
   178                                 
   179 00000211 0A4353203231382042-    graphHeader db LF, "CS 218 Benfords Law", LF
   180 00000211 656E666F726473204C-
   181 00000211 61770A             
   182 00000226 546573742052657375-     db "Test Results", LF, LF, NULL
   183 00000226 6C74730A0A00       
   184                                 
   185 00000235 546F74616C20446174-    graphLine1 db "Total Data Points: "
   186 00000235 6120506F696E74733A-
   187 00000235 20                 
   188 00000248 202020202020202020-    tStr1 db "                 ", LF, LF, NULL
   189 00000248 20202020202020200A-
   190 00000248 0A00               
   191                                 
   192                                 DIGITS_SIZE equ 15
   193                                 STARS_SIZE equ 50
   194                                 
   195 0000025C 2020                   graphLine2 db "  "
   196 0000025E 78                     index2 db "x"
   197 0000025F 2020                    db "  "
   198 00000261 2020202020202020       num2 db "        "
   199 00000269 7C                      db "|"
   200 0000026A 202020202020202020-    stars2 db "                              "
   201 0000026A 202020202020202020-
   202 0000026A 202020202020202020-
   203 0000026A 202020             
   204 00000288 202020202020202020-     db "                     "
   205 00000288 202020202020202020-
   206 00000288 202020             
   207 0000029D 0A00                    db LF, NULL
   208                                 
   209 0000029F 202020202020202020-    graphLine3 db "               ----------------------------------------------"
   210 0000029F 2020202020202D2D2D-
   211 0000029F 2D2D2D2D2D2D2D2D2D-
   212 0000029F 2D2D2D2D2D2D2D2D2D-
   213 0000029F 2D2D2D2D2D2D2D2D2D-
   214 0000029F 2D2D2D2D2D2D2D2D2D-
   215 0000029F 2D2D2D2D2D2D2D     
   216 000002DC 0A0A00                  db LF, LF, NULL
   217                                 
   218                                 
   219                                 
   220                                 
   221                                 [section .bss]
   222                                 
   223 00000000 <gap>                  buff resb BUFFSIZE+1
   224                                 
   225                                 
   226                                 
   227                                 
   228                                 [section .text]
   229                                 
   230                                 
   231                                 
   232                                 
   233                                 
   234                                 
   235                                 
   236                                 
   237                                 
   238                                 
   239                                 
   240                                 
   241                                 
   242                                 
   243                                 
   244                                 
   245                                 
   246                                 
   247                                 
   248                                 
   249                                 
   250                                 
   251                                 
   252                                 
   253                                 
   254                                 
   255                                 [global getArguments]
   256                                 getArguments:
   257                                 
   258 00000000 53                      push rbx
   259 00000001 4154                    push r12
   260 00000003 4155                    push r13
   261 00000005 4156                    push r14
   262                                 
   263 00000007 4989F4                  mov r12, rsi
   264 0000000A 4989D5                  mov r13, rdx
   265 0000000D 4989CE                  mov r14, rcx
   266                                 
   267                                 
   268 00000010 4883FF01                cmp rdi, 1
   269 00000014 0F84C6000000            je usage
   270                                 
   271                                 
   272 0000001A 4883FF07                cmp rdi, 7
   273 0000001E 0F8FD4000000            jg many
   274                                 
   275                                 
   276 00000024 4883FF07                cmp rdi, 7
   277 00000028 0F8CE2000000            jl few
   278                                 
   279                                 
   280 0000002E 498B5C2408              mov rbx, qword[r12+8]
   281 00000033 66813B2D69              cmp word[rbx], 0x692d
   282 00000038 0F85EA000000            jne invalidInputSpecifier
   283                                 
   284                                 
   285 0000003E 48C7C002000000          mov rax, SYS_open
   286 00000045 498B7C2410              mov rdi, qword[r12+16]
   287 0000004A 48C7C600000000          mov rsi, O_RDONLY
   288 00000051 0F05                    syscall
   289                                 
   290 00000053 4883F800                cmp rax, 0
   291 00000057 0F8CE3000000            jl errorOnInputFile
   292                                 
   293 0000005D 49894500                mov qword[r13], rax
   294 00000061 48890425[00000000]      mov qword[rdFileDescriptor], rax
   295                                 
   296                                 
   297 00000069 498B5C2418              mov rbx, qword[r12+24]
   298 0000006E 66813B2D6F              cmp word[rbx], 0x6f2d
   299 00000073 0F85DF000000            jne invalidOutputSpecifier
   300                                 
   301                                 
   302 00000079 48C7C055000000          mov rax, SYS_creat
   303 00000080 498B7C2420              mov rdi, qword[r12+32]
   304 00000085 48C7C680010000          mov rsi, S_IRUSR | S_IWUSR
   305 0000008C 0F05                    syscall
   306                                 
   307 0000008E 4883F800                cmp rax, 0
   308 00000092 0F8CD5000000            jl errorOnOutputFile
   309                                 
   310 00000098 498906                  mov qword[r14], rax
   311                                 
   312 0000009B 48C7C002000000          mov rax, SYS_open
   313 000000A2 498B7C2420              mov rdi, qword[r12+32]
   314 000000A7 48C7C600000000          mov rsi, O_RDONLY
   315 000000AE 0F05                    syscall
   316                                 
   317 000000B0 4883F800                cmp rax, 0
   318 000000B4 0F8CB3000000            jl errorOnOutputFile
   319                                 
   320                                 
   321 000000BA 498B5C2428              mov rbx, qword[r12+40]
   322 000000BF 66813B2D64              cmp word[rbx], 0x642d
   323 000000C4 0F85B8000000            jne invalidDisplaySpecifier
   324                                 
   325                                 
   326 000000CA 498B5C2430              mov rbx, qword[r12+48]
   327                                 
   328                                 
   329 000000CF 803B54                  cmp byte[rbx], 0x54
   330 000000D2 0F84BF000000            je displayTrue
   331                                 
   332 000000D8 803B46                  cmp byte[rbx], 0x46
   333 000000DB 0F84D2000000            je displayFalse
   334                                 
   335                                 
   336                                 
   337 000000E1 E9EA000000              jmp invalidDisplayOption
   338                                 
   339                                 
   340                                  usage:
   341 000000E6 48C7C7[00000000]        mov rdi, usageMsg
   342 000000ED E818050000              call printString
   343 000000F2 48C7C000000000          mov rax, FALSE
   344 000000F9 E9E7000000              jmp argsDone
   345                                 
   346                                  many:
   347 000000FE 48C7C7[00000000]        mov rdi, errMany
   348 00000105 E800050000              call printString
   349 0000010A 48C7C000000000          mov rax, FALSE
   350 00000111 E9CF000000              jmp argsDone
   351                                 
   352                                  few:
   353 00000116 48C7C7[00000000]        mov rdi, errFew
   354 0000011D E8E8040000              call printString
   355 00000122 48C7C000000000          mov rax, FALSE
   356 00000129 E9B7000000              jmp argsDone
   357                                 
   358                                  invalidInputSpecifier:
   359 0000012E 48C7C7[00000000]        mov rdi, errISpec
   360 00000135 E8D0040000              call printString
   361 0000013A 48C7C000000000          mov rax, FALSE
   362 00000141 E99F000000              jmp argsDone
   363                                 
   364                                  errorOnInputFile:
   365 00000146 48C7C7[00000000]        mov rdi, errOpenIn
   366 0000014D E8B8040000              call printString
   367 00000152 48C7C000000000          mov rax, FALSE
   368 00000159 E987000000              jmp argsDone
   369                                 
   370                                  invalidOutputSpecifier:
   371 0000015E 48C7C7[00000000]        mov rdi, errOSpec
   372 00000165 E8A0040000              call printString
   373 0000016A 48C7C000000000          mov rax, FALSE
   374 00000171 EB75                    jmp argsDone
   375                                 
   376                                  errorOnOutputFile:
   377 00000173 48C7C7[00000000]        mov rdi, errOpenOut
   378 0000017A E88B040000              call printString
   379 0000017F 48C7C000000000          mov rax, FALSE
   380 00000186 EB60                    jmp argsDone
   381                                 
   382                                  invalidDisplaySpecifier:
   383 00000188 48C7C7[00000000]        mov rdi, errDSpec
   384 0000018F E876040000              call printString
   385 00000194 48C7C000000000          mov rax, FALSE
   386 0000019B EB4B                    jmp argsDone
   387                                 
   388                                  displayTrue:
   389 0000019D 49C70001000000          mov qword[r8], TRUE
   390 000001A4 48C7C001000000          mov rax, TRUE
   391 000001AB 488B1C25[00000000]      mov rbx, qword[rdFileDescriptor]
   392 000001B3 49895D00                mov qword[r13], rbx
   393 000001B7 EB2F                    jmp argsDone
   394                                 
   395                                  displayFalse:
   396 000001B9 49C70000000000          mov qword[r8], FALSE
   397 000001C0 488B1C25[00000000]      mov rbx, qword[rdFileDescriptor]
   398 000001C8 49895D00                mov qword[r13], rbx
   399 000001CC 48C7C001000000          mov rax, TRUE
   400 000001D3 EB13                    jmp argsDone
   401                                 
   402                                  invalidDisplayOption:
   403 000001D5 48C7C7[00000000]        mov rdi, errTF
   404 000001DC E829040000              call printString
   405 000001E1 48C7C000000000          mov rax, FALSE
   406 000001E8 EBFE                    jmp argsDone
   407                                 
   408                                  argsDone:
   409                                 
   410 000001EA 415E                    pop r14
   411 000001EC 415D                    pop r13
   412 000001EE 415C                    pop r12
   413 000001F0 5B                      pop rbx
   414 000001F1 C3                     ret
   415                                 
   416                                 
   417                                 
   418                                 
   419                                 
   420                                 
   421                                 
   422                                 
   423                                 
   424                                 
   425                                 
   426                                 
   427                                 
   428                                 
   429                                 
   430                                 
   431                                 
   432                                 
   433                                 
   434                                 
   435                                 
   436                                 
   437                                 
   438                                 
   439                                 [global int2octal]
   440                                 int2octal:
   441                                 
   442 000001F2 4154                    push r12
   443 000001F4 4155                    push r13
   444                                 
   445 000001F6 49C7C408000000          mov r12, 8
   446 000001FD 48C7C100000000          mov rcx, 0
   447 00000204 4989F5                  mov r13, rsi
   448                                 
   449                                 
   450 00000207 4889F8                  mov rax, rdi
   451                                 
   452                                  convertLp:
   453 0000020A 48C7C200000000          mov rdx, 0
   454 00000211 49F7F4                  div r12
   455                                 
   456 00000214 52                      push rdx
   457 00000215 48FFC1                  inc rcx
   458                                 
   459                                 
   460 00000218 4883F800                cmp rax, 0
   461 0000021C 7400                    je cvtPushDone
   462                                 
   463 0000021E EBE8                    jmp convertLp
   464                                 
   465                                  cvtPushDone:
   466                                 
   467                                 
   468 00000220 48C7C200000000          mov rdx, 0
   469                                  popLp:
   470                                 
   471 00000227 415C                    pop r12
   472 00000229 48FFC9                  dec rcx
   473 0000022C 4983C430                add r12, "0"
   474 00000230 4588641500              mov byte[r13+rdx], r12b
   475                                 
   476 00000235 48FFC2                  inc rdx
   477                                 
   478 00000238 4883F900                cmp rcx, 0
   479 0000023C 7400                    je convertDone
   480 0000023E EBE5                    jmp popLp
   481                                 
   482                                  convertDone:
   483                                 
   484                                 
   485 00000240 48C7C001000000          mov rax, TRUE
   486                                 
   487                                 
   488 00000247 415D                    pop r13
   489 00000249 415C                    pop r12
   490                                 
   491 0000024B C3                     ret
   492                                 
   493                                 
   494                                 
   495                                 
   496                                 
   497                                 
   498                                 
   499                                 
   500                                 
   501                                 
   502                                 
   503                                 
   504                                 
   505                                 
   506                                 
   507                                 
   508                                 
   509                                 
   510                                 
   511                                 
   512                                 [global countDigits]
   513                                 countDigits:
   514                                 
   515 0000024C 4154                    push r12
   516 0000024E 4155                    push r13
   517                                 
   518 00000250 4989FC                  mov r12, rdi
   519 00000253 4989F5                  mov r13, rsi
   520                                 
   521                                  mainLp:
   522                                 
   523 00000256 488B3C25[00000000]      mov rdi, qword[curr]
   524 0000025E 488B3425[00000000]      mov rsi, qword[bfMax]
   525                                 
   526 00000266 4839F7                  cmp rdi, rsi
   527 00000269 7C5B                    jl endMainLp
   528                                 
   529 0000026B 803C25[00000000]01      cmp byte[wasEOF], TRUE
   530 00000273 0F8444010000            je exitCount
   531                                 
   532                                 
   533                                 
   534 00000279 48C7C000000000          mov rax, SYS_read
   535 00000280 4C89E7                  mov rdi, r12
   536 00000283 48C7C6[00000000]        mov rsi, buff
   537 0000028A 48C7C201000000          mov rdx, BUFFSIZE
   538 00000291 0F05                    syscall
   539                                 
   540                                 
   541                                 
   542 00000293 4883F800                cmp rax, 0
   543 00000297 0F8C12010000            jl errOnRead
   544                                 
   545                                 
   546 0000029D 83F800                  cmp eax, 0
   547 000002A0 0F8417010000            je exitCount
   548                                 
   549                                 
   550 000002A6 83F801                  cmp eax, BUFFSIZE
   551 000002A9 7C00                    jl reachedEndOfFile
   552                                 
   553 000002AB EB0D                    jmp notEndOfFile
   554                                 
   555                                  reachedEndOfFile:
   556                                 
   557                                 
   558 000002AD C60425[00000000]01      mov byte[wasEOF], TRUE
   559 000002B5 890425[00000000]        mov dword[bfMax], eax
   560                                 
   561                                  notEndOfFile:
   562                                 
   563                                 
   564                                 
   565 000002BC 48C70425[00000000]-     mov qword[curr], 0
   566 000002BC 00000000           
   567                                 
   568                                 
   569                                  endMainLp:
   570                                 
   571                                 
   572                                 
   573 000002C8 488B3425[00000000]      mov rsi, qword[curr]
   574 000002D0 8A96[00000000]          mov dl, byte[buff+rsi]
   575 000002D6 881425[00000000]        mov byte[chr], dl
   576                                 
   577                                 
   578                                 
   579                                 
   580 000002DD 833C25[00000000]05      cmp dword[skipLineCount], SKIP_LINES
   581 000002E5 7D1C                    jge skipLineDone
   582                                 
   583 000002E7 803C25[00000000]0A      cmp byte[chr], LF
   584 000002EF 7505                    jne noLineCnt
   585 000002F1 FF0425[00000000]        inc dword[skipLineCount]
   586                                  noLineCnt:
   587                                 
   588                                 
   589 000002F8 48FF0425[00000000]      inc qword[curr]
   590                                 
   591 00000300 E94CFFFFFF              jmp mainLp
   592                                 
   593                                  skipLineDone:
   594                                 
   595                                 
   596                                 
   597 00000305 833C25[00000000]06      cmp dword[skipCharCount], SKIP_CHARS
   598 0000030D 7F12                    jg skipCharDone
   599                                 
   600                                 
   601                                 
   602 0000030F FF0425[00000000]        inc dword[skipCharCount]
   603                                 
   604                                 
   605 00000316 48FF0425[00000000]      inc qword[curr]
   606                                 
   607                                 
   608 0000031E E92EFFFFFF              jmp mainLp
   609                                 
   610                                  skipCharDone:
   611                                 
   612                                 
   613 00000323 803C25[00000000]20      cmp byte[chr], 0x20
   614 0000032B 750B                    jne skipSpace
   615                                 
   616                                 
   617 0000032D 48FF0425[00000000]      inc qword[curr]
   618 00000335 E917FFFFFF              jmp mainLp
   619                                 
   620                                  skipSpace:
   621                                 
   622                                 
   623 0000033A 803C25[00000000]01      cmp byte[gotDigit], TRUE
   624 00000342 7438                    je notFirstDigit
   625                                 
   626                                 
   627 00000344 48C7C000000000          mov rax, 0
   628 0000034B 8A0425[00000000]        mov al, byte[chr]
   629 00000352 2C30                    sub al, "0"
   630 00000354 880425[00000000]        mov byte[fDigit], al
   631                                 
   632                                 
   633 0000035B 418344850001            add dword[r13+rax*4], 1
   634                                 
   635 00000361 48FF0425[00000000]      inc qword[curr]
   636 00000369 48FF0425[00000000]      inc qword[totalCnt]
   637                                 
   638                                 
   639 00000371 C60425[00000000]01      mov byte[gotDigit], TRUE
   640 00000379 E9D3FEFFFF              jmp mainLp
   641                                 
   642                                  notFirstDigit:
   643                                 
   644                                 
   645 0000037E 803C25[00000000]0A      cmp byte[chr], LF
   646 00000386 751E                    jne notNewLine
   647                                 
   648 00000388 C70425[00000000]00-     mov dword[skipCharCount], 0
   649 00000388 000000             
   650                                 
   651                                 
   652 00000393 C60425[00000000]00      mov byte[gotDigit], FALSE
   653                                 
   654 0000039B 48FF0425[00000000]      inc qword[curr]
   655 000003A3 E9A9FEFFFF              jmp mainLp
   656                                 
   657                                  notNewLine:
   658                                 
   659                                 
   660 000003A8 48FF0425[00000000]      inc qword[curr]
   661 000003B0 E99CFEFFFF              jmp mainLp
   662                                 
   663                                  errOnRead:
   664                                 
   665 000003B5 48C7C7[00000000]        mov rdi, errFileRead
   666 000003BC E849020000              call printString
   667 000003C1 EBFE                    jmp exitCount
   668                                 
   669                                  exitCount:
   670                                 
   671                                 
   672 000003C3 415D                    pop r13
   673 000003C5 415C                    pop r12
   674                                 
   675                                 
   676 000003C7 C3                     ret
   677                                 
   678                                 
   679                                 
   680                                 
   681                                 
   682                                 
   683                                 
   684                                 
   685                                 
   686                                 
   687                                 
   688                                 
   689                                 
   690                                 
   691                                 
   692                                 
   693                                 
   694                                 
   695                                 
   696                                 [global showGraph]
   697                                 showGraph:
   698                                 
   699                                 
   700 000003C8 4154                    push r12
   701 000003CA 4155                    push r13
   702 000003CC 4156                    push r14
   703                                 
   704 000003CE 4989FC                  mov r12, rdi
   705 000003D1 4989F5                  mov r13, rsi
   706 000003D4 4989D6                  mov r14, rdx
   707                                 
   708                                 
   709                                 
   710                                 
   711 000003D7 488B0425[00000000]      mov rax, qword[totalCnt]
   712 000003DF 483DA0860100            cmp rax, 100000
   713 000003E5 7C10                    jl scaleOne
   714                                 
   715 000003E7 483D20A10700            cmp rax, 500000
   716 000003ED 7C15                    jl scaleTwo
   717                                 
   718 000003EF 483D40420F00            cmp rax, 1000000
   719 000003F5 7C1A                    jl scaleThree
   720                                 
   721 000003F7 EB25                    jmp scaleFour
   722                                 
   723                                  scaleOne:
   724 000003F9 C70425[00000000]64-     mov dword[scale], SCALE1
   725 000003F9 000000             
   726 00000404 EB25                    jmp scaleDone
   727                                 
   728                                  scaleTwo:
   729 00000406 C70425[00000000]E8-     mov dword[scale], SCALE2
   730 00000406 030000             
   731 00000411 EB18                    jmp scaleDone
   732                                 
   733                                  scaleThree:
   734 00000413 C70425[00000000]C4-     mov dword[scale], SCALE3
   735 00000413 090000             
   736 0000041E EB0B                    jmp scaleDone
   737                                 
   738                                  scaleFour:
   739 00000420 C70425[00000000]88-     mov dword[scale], SCALE4
   740 00000420 130000             
   741 0000042B EBFE                    jmp scaleDone
   742                                 
   743                                  scaleDone:
   744                                 
   745                                 
   746 0000042D 4C89E7                  mov rdi, r12
   747 00000430 48C7C6[00000000]        mov rsi, graphHeader
   748 00000437 E87F010000              call writeString
   749                                 
   750                                 
   751 0000043C 4983FE00                cmp r14, FALSE
   752 00000440 740A                    je noPrintHeader
   753                                 
   754 00000442 48C7C7[00000000]        mov rdi, graphHeader
   755 00000449 E8BC010000              call printString
   756                                 
   757                                  noPrintHeader:
   758                                 
   759 0000044E 488B3C25[00000000]      mov rdi, qword[totalCnt]
   760 00000456 48C7C6[00000000]        mov rsi, tStr1
   761 0000045D E88BFDFFFF              call int2octal
   762                                 
   763 00000462 4C89E7                  mov rdi, r12
   764 00000465 48C7C6[00000000]        mov rsi, graphLine1
   765 0000046C E84A010000              call writeString
   766                                 
   767                                 
   768 00000471 4983FE00                cmp r14, FALSE
   769 00000475 740A                    je noPrintDataPoints
   770                                 
   771 00000477 48C7C7[00000000]        mov rdi, graphLine1
   772 0000047E E887010000              call printString
   773                                 
   774                                  noPrintDataPoints:
   775                                 
   776                                 
   777 00000483 48C7C600000000          mov rsi, 0
   778                                  clearNumTwo:
   779 0000048A C686[00000000]20        mov byte[num2+rsi], 0x20
   780 00000491 48FFC6                  inc rsi
   781 00000494 4883FE0A                cmp rsi, 10
   782 00000498 75EE                    jne clearNumTwo
   783                                 
   784                                 
   785                                 
   786 0000049A 49C7C200000000          mov r10, 0
   787 000004A1 49C7C100000000          mov r9, 0
   788 000004A8 49C7C030000000          mov r8, "0"
   789 000004AF 48C7C700000000          mov rdi, 0
   790                                  graphLp:
   791                                 
   792 000004B6 44880425[00000000]      mov byte[index2], r8b
   793                                 
   794 000004BE 478B4C9500              mov r9d, dword[r13+r10*4]
   795 000004C3 44890C25[00000000]      mov dword[currCount], r9d
   796                                 
   797                                 
   798 000004CB 8B3C25[00000000]        mov edi, dword[currCount]
   799 000004D2 48C7C6[00000000]        mov rsi, num2
   800 000004D9 E80FFDFFFF              call int2octal
   801                                 
   802                                 
   803 000004DE 8B0425[00000000]        mov eax, dword[currCount]
   804 000004E5 99                      cdq
   805 000004E6 F73425[00000000]        div dword[scale]
   806 000004ED 83F800                  cmp eax, 0
   807 000004F0 7430                    je zeroStars
   808                                 
   809                                 
   810 000004F2 83F82C                  cmp eax, 44
   811 000004F5 7C03                    jl notMaxStar
   812                                 
   813 000004F7 B82C000000              mov eax, 44
   814                                 
   815                                  notMaxStar:
   816                                 
   817 000004FC 890425[00000000]        mov dword[starCount], eax
   818 00000503 FF0425[00000000]        inc dword[starCount]
   819                                 
   820                                 
   821 0000050A 48C7C600000000          mov rsi, 0
   822                                  starLp:
   823                                 
   824 00000511 C686[00000000]2A        mov byte[stars2+rsi], "*"
   825 00000518 48FFC6                  inc rsi
   826 0000051B 3B3425[00000000]        cmp esi, dword[starCount]
   827 00000522 75EB                    jne starLp
   828                                 
   829                                  zeroStars:
   830                                 
   831 00000524 C60425[00000000]7C      mov byte[stars2], "|"
   832                                 
   833 0000052C 4C89E7                  mov rdi, r12
   834 0000052F 48C7C6[00000000]        mov rsi, graphLine2
   835 00000536 E880000000              call writeString
   836                                 
   837                                 
   838 0000053B 4983FE00                cmp r14, FALSE
   839 0000053F 740A                    je noPrintStars
   840                                 
   841 00000541 48C7C7[00000000]        mov rdi, graphLine2
   842 00000548 E8BD000000              call printString
   843                                 
   844                                  noPrintStars:
   845                                 
   846                                 
   847 0000054D 48C7C600000000          mov rsi, 0
   848 00000554 833C25[00000000]00      cmp dword[starCount], 0
   849 0000055C 7411                    je noStars
   850                                 
   851                                  clearStar:
   852 0000055E C686[00000000]20        mov byte[stars2+rsi], 0x20
   853 00000565 48FFC6                  inc rsi
   854 00000568 3B3425[00000000]        cmp esi, dword[starCount]
   855 0000056F 75EB                    jne clearStar
   856                                 
   857                                 
   858                                  noStars:
   859                                 
   860                                 
   861 00000571 48C7C600000000          mov rsi, 0
   862                                  clearNum2:
   863 00000578 C686[00000000]20        mov byte[num2+rsi], 0x20
   864 0000057F 48FFC6                  inc rsi
   865 00000582 4883FE07                cmp rsi, 7
   866 00000586 75EE                    jne clearNum2
   867                                 
   868                                 
   869                                 
   870 00000588 49FFC0                  inc r8
   871 0000058B 49FFC2                  inc r10
   872 0000058E 4983FA0A                cmp r10, 10
   873 00000592 0F8518FFFFFF            jne graphLp
   874                                 
   875 00000598 4C89E7                  mov rdi, r12
   876 0000059B 48C7C6[00000000]        mov rsi, graphLine3
   877 000005A2 E814000000              call writeString
   878                                 
   879                                 
   880 000005A7 4983FE00                cmp r14, FALSE
   881 000005AB 740A                    je noPrintLast
   882                                 
   883 000005AD 48C7C7[00000000]        mov rdi, graphLine3
   884 000005B4 E851000000              call printString
   885                                 
   886                                  noPrintLast:
   887                                 
   888 000005B9 415E                    pop r14
   889 000005BB 415D                    pop r13
   890 000005BD 415C                    pop r12
   891 000005BF C3                     ret
   892                                 
   893                                 
   894                                 
   895                                 
   896                                 
   897                                 
   898                                 
   899                                 
   900                                 
   901                                 
   902                                 
   903                                 
   904                                 
   905                                 
   906                                 
   907                                 
   908                                 
   909                                 
   910                                 [global writeString]
   911                                 writeString:
   912                                 
   913 000005C0 4154                    push r12
   914 000005C2 4155                    push r13
   915 000005C4 4156                    push r14
   916                                 
   917 000005C6 4989FC                  mov r12, rdi
   918 000005C9 4989F5                  mov r13, rsi
   919                                 
   920                                 
   921 000005CC 49C7C600000000          mov r14, 0
   922                                 
   923                                 
   924                                  countChar:
   925                                 
   926 000005D3 803E00                  cmp byte[rsi], NULL
   927 000005D6 7406                    je charCountDone
   928 000005D8 49FFC6                  inc r14
   929 000005DB 48FFC6                  inc rsi
   930 000005DE EBF1                    jmp countChar
   931                                  charCountDone:
   932                                 
   933                                 
   934 000005E0 48C7C001000000          mov rax, SYS_write
   935 000005E7 4C89E7                  mov rdi, r12
   936 000005EA 4C89EE                  mov rsi, r13
   937 000005ED 4C89F2                  mov rdx, r14
   938 000005F0 0F05                    syscall
   939                                 
   940 000005F2 4883F800                cmp rax, 0
   941 000005F6 7C00                    jl errorOnWrite
   942                                 
   943 000005F8 EB0C                    jmp endWrite
   944                                 
   945                                  errorOnWrite:
   946                                 
   947 000005FA 48C7C7[00000000]        mov rdi, errFileWrite
   948 00000601 E804000000              call printString
   949 00000606 EBFE                    jmp endWrite
   950                                 
   951                                  endWrite:
   952                                 
   953 00000608 415E                    pop r14
   954 0000060A 415D                    pop r13
   955 0000060C 415C                    pop r12
   956 0000060E C3                     ret
   957                                 
   958                                 
   959                                 
   960                                 
   961                                 
   962                                 
   963                                 
   964                                 
   965                                 
   966                                 
   967                                 
   968                                 
   969                                 
   970                                 
   971                                 
   972                                 
   973                                 
   974                                 
   975                                 
   976                                 [global printString]
   977                                 printString:
   978                                 
   979                                 
   980                                 
   981                                 
   982 0000060F 48C7C200000000          mov rdx, 0
   983                                 strCountLoop:
   984 00000616 803C1700                cmp byte [rdi+rdx], NULL
   985 0000061A 7403                    je strCountLoopDone
   986 0000061C 48FFC2                  inc rdx
   987 0000061F EBF3                    jmp strCountLoop
   988                                 strCountLoopDone:
   989 00000621 4883FA00                cmp rdx, 0
   990 00000625 7411                    je printStringDone
   991                                 
   992                                 
   993                                 
   994                                 
   995 00000627 48C7C001000000          mov rax, SYS_write
   996 0000062E 4889FE                  mov rsi, rdi
   997 00000631 48C7C701000000          mov rdi, STDOUT
   998                                 
   999 00000638 0F05                    syscall
  1000                                 
  1001                                 
  1002                                 
  1003                                 
  1004                                 printStringDone:
  1005 0000063A C3                      ret
  1006                                 
  1007                                 
  1008                                 
