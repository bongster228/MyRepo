     1                                 %line 1+1 ast11.asm
     2                                 
     3                                 
     4                                 
     5                                 
     6                                 
     7                                 
     8                                 
     9                                 
    10                                 
    11                                 
    12                                 
    13                                 
    14                                 
    15                                 
    16                                 
    17                                 
    18                                 
    19                                 
    20                                 
    21                                 
    22                                 [section .data]
    23                                 
    24                                 
    25                                 
    26                                 
    27                                 LF equ 10
    28                                 NULL equ 0
    29                                 SPACE equ 0x20
    30                                 
    31                                 TRUE equ 1
    32                                 FALSE equ 0
    33                                 
    34                                 EXIT_SUCCESS equ 0
    35                                 EXIT_NOSUCCESS equ 1
    36                                 
    37                                 STDIN equ 0
    38                                 STDOUT equ 1
    39                                 STDERR equ 2
    40                                 
    41                                 SYS_read equ 0
    42                                 SYS_write equ 1
    43                                 SYS_open equ 2
    44                                 SYS_close equ 3
    45                                 SYS_fork equ 57
    46                                 SYS_exit equ 60
    47                                 SYS_creat equ 85
    48                                 SYS_time equ 201
    49                                 
    50                                 O_CREAT equ 0x40
    51                                 O_TRUNC equ 0x200
    52                                 O_APPEND equ 0x400
    53                                 
    54                                 O_RDONLY equ 000000
    55                                 O_WRONLY equ 000001
    56                                 O_RDWR equ 000002
    57                                 
    58                                 S_IRUSR equ 00400
    59                                 S_IWUSR equ 00200
    60                                 S_IXUSR equ 00100
    61                                 
    62                                 
    63                                 
    64                                 
    65 00000000 55736167653A202E2F-    usageMsg db "Usage: ./benford -i <inputFileName> "
    66 00000000 62656E666F7264202D-
    67 00000000 69203C696E70757446-
    68 00000000 696C654E616D653E20 
    69 00000024 2D6F203C6F75747075-     db "-o <outputFileName> -d <T/F>", LF, NULL
    70 00000024 7446696C654E616D65-
    71 00000024 3E202D64203C542F46-
    72 00000024 3E0A00             
    73                                 
    74 00000042 4572726F722C20746F-    errMany db "Error, too many characters on the "
    75 00000042 6F206D616E79206368-
    76 00000042 617261637465727320-
    77 00000042 6F6E2074686520     
    78 00000064 636F6D6D616E64206C-     db "command line.", LF, NULL
    79 00000064 696E652E0A00       
    80                                 
    81 00000073 4572726F722C20746F-    errFew db "Error, too few characters on the "
    82 00000073 6F2066657720636861-
    83 00000073 72616374657273206F-
    84 00000073 6E2074686520       
    85 00000094 636F6D6D616E64206C-     db "command line.", LF, NULL
    86 00000094 696E652E0A00       
    87                                 
    88 000000A3 4572726F722C20696E-    errDSpec db "Error, invalid output display specifier."
    89 000000A3 76616C6964206F7574-
    90 000000A3 70757420646973706C-
    91 000000A3 617920737065636966-
    92 000000A3 6965722E           
    93 000000CB 0A00                    db LF, NULL
    94                                 
    95 000000CD 4572726F722C20696E-    errISpec db "Error, invalid input file specifier."
    96 000000CD 76616C696420696E70-
    97 000000CD 75742066696C652073-
    98 000000CD 70656369666965722E 
    99 000000F1 0A00                    db LF, NULL
   100                                 
   101 000000F3 4572726F722C20696E-    errOSpec db "Error, invalid output file specifier."
   102 000000F3 76616C6964206F7574-
   103 000000F3 7075742066696C6520-
   104 000000F3 737065636966696572-
   105 000000F3 2E                 
   106 00000118 0A00                    db LF, NULL
   107                                 
   108 0000011A 4572726F722C20696E-    errTF db "Error, invalid display option. Must be T or F."
   109 0000011A 76616C696420646973-
   110 0000011A 706C6179206F707469-
   111 0000011A 6F6E2E204D75737420-
   112 0000011A 62652054206F722046-
   113 0000011A 2E                 
   114 00000148 0A00                    db LF, NULL
   115                                 
   116 0000014A 4572726F722C206361-    errOpenIn db "Error, can not open input file."
   117 0000014A 6E206E6F74206F7065-
   118 0000014A 6E20696E7075742066-
   119 0000014A 696C652E           
   120 00000169 0A00                    db LF, NULL
   121                                 
   122 0000016B 4572726F722C206361-    errOpenOut db "Error, can not open output file."
   123 0000016B 6E206E6F74206F7065-
   124 0000016B 6E206F757470757420-
   125 0000016B 66696C652E         
   126 0000018B 0A00                    db LF, NULL
   127                                 
   128 0000018D 0000000000000000       rdFileDescriptor dq 0
   129 00000195 0000000000000000       wrFileDescriptor dq 0
   130                                 
   131                                 
   132                                 
   133                                 
   134                                 BUFFSIZE equ 500000
   135                                 
   136                                 SKIP_LINES equ 5
   137                                 SKIP_CHARS equ 6
   138                                 
   139 0000019D 01                     nextCharIsFirst db TRUE
   140 0000019E 00000000               skipLineCount dd 0
   141 000001A2 00000000               skipCharCount dd 0
   142 000001A6 00                     gotDigit db FALSE
   143 000001A7 00                     fDigit db 0
   144 000001A8 00                     chr db 0
   145                                 
   146                                 
   147 000001A9 20A1070000000000       bfMax dq BUFFSIZE
   148 000001B1 20A1070000000000       curr dq BUFFSIZE
   149                                 
   150 000001B9 00                     wasEOF db FALSE
   151                                 
   152 000001BA 4572726F7220726561-    errFileRead db "Error reading input file."
   153 000001BA 64696E6720696E7075-
   154 000001BA 742066696C652E     
   155 000001D3 50726F6772616D2074-     db "Program terminated."
   156 000001D3 65726D696E61746564-
   157 000001D3 2E                 
   158 000001E6 0A00                    db LF, NULL
   159                                 
   160                                 
   161                                 
   162                                 
   163                                 
   164                                 SCALE1 equ 100
   165                                 SCALE2 equ 1000
   166                                 SCALE3 equ 2500
   167                                 SCALE4 equ 5000
   168                                 
   169 000001E8 64000000               scale dd SCALE1
   170 000001EC 00000000               totalCnt dd 0
   171 000001F0 00000000               currCount dd 0
   172 000001F4 00000000               starCount dd 0
   173                                 
   174 000001F8 03000000               weight dd 3
   175                                 
   176 000001FC 4572726F7220777269-    errFileWrite db "Error writting output file."
   177 000001FC 7474696E67206F7574-
   178 000001FC 7075742066696C652E 
   179 00000217 0A00                    db LF, NULL
   180                                 
   181 00000219 0A4353203231382042-    graphHeader db LF, "CS 218 Benfords Law", LF
   182 00000219 656E666F726473204C-
   183 00000219 61770A             
   184 0000022E 546573742052657375-     db "Test Results", LF, LF, NULL
   185 0000022E 6C74730A0A00       
   186                                 
   187 0000023D 546F74616C20446174-    graphLine1 db "Total Data Points: "
   188 0000023D 6120506F696E74733A-
   189 0000023D 20                 
   190 00000250 0A0A00                 tStr1 db "", LF, LF, NULL
   191                                 
   192                                 DIGITS_SIZE equ 15
   193                                 STARS_SIZE equ 50
   194                                 
   195 00000253 2020                   graphLine2 db "  "
   196 00000255 78                     index2 db "x"
   197 00000256 20                      db " "
   198 00000257 2020202020202020       num2 db "        "
   199 0000025F 7C                      db "|"
   200 00000260 202020202020202020-    stars2 db "                              "
   201 00000260 202020202020202020-
   202 00000260 202020202020202020-
   203 00000260 202020             
   204 0000027E 202020202020202020-     db "                    "
   205 0000027E 202020202020202020-
   206 0000027E 2020               
   207 00000292 0A00                    db LF, NULL
   208                                 
   209 00000294 202020202020202020-    graphLine3 db "                     ---------------------------------------------"
   210 00000294 202020202020202020-
   211 00000294 2020202D2D2D2D2D2D-
   212 00000294 2D2D2D2D2D2D2D2D2D-
   213 00000294 2D2D2D2D2D2D2D2D2D-
   214 00000294 2D2D2D2D2D2D2D2D2D-
   215 00000294 2D2D2D2D2D2D2D2D2D-
   216 00000294 2D2D2D             
   217 000002D6 0A0A00                  db LF, LF, NULL
   218                                 
   219                                 
   220                                 
   221                                 
   222                                 [section .bss]
   223                                 
   224 00000000 <gap>                  buff resb BUFFSIZE+1
   225                                 
   226                                 
   227                                 
   228                                 
   229                                 [section .text]
   230                                 
   231                                 
   232                                 
   233                                 
   234                                 
   235                                 
   236                                 
   237                                 
   238                                 
   239                                 
   240                                 
   241                                 
   242                                 
   243                                 
   244                                 
   245                                 
   246                                 
   247                                 
   248                                 
   249                                 
   250                                 
   251                                 
   252                                 
   253                                 
   254                                 
   255                                 
   256                                 [global getArguments]
   257                                 getArguments:
   258                                 
   259 00000000 53                      push rbx
   260 00000001 4154                    push r12
   261 00000003 4155                    push r13
   262 00000005 4156                    push r14
   263                                 
   264 00000007 4989F4                  mov r12, rsi
   265 0000000A 4989D5                  mov r13, rdx
   266 0000000D 4989CE                  mov r14, rcx
   267                                 
   268                                 
   269 00000010 4883FF01                cmp rdi, 1
   270 00000014 0F84C6000000            je usage
   271                                 
   272                                 
   273 0000001A 4883FF07                cmp rdi, 7
   274 0000001E 0F8FD4000000            jg many
   275                                 
   276                                 
   277 00000024 4883FF07                cmp rdi, 7
   278 00000028 0F8CE2000000            jl few
   279                                 
   280                                 
   281 0000002E 498B5C2408              mov rbx, qword[r12+8]
   282 00000033 66813B2D69              cmp word[rbx], 0x692d
   283 00000038 0F85EA000000            jne invalidInputSpecifier
   284                                 
   285                                 
   286 0000003E 48C7C002000000          mov rax, SYS_open
   287 00000045 498B7C2410              mov rdi, qword[r12+16]
   288 0000004A 48C7C600000000          mov rsi, O_RDONLY
   289 00000051 0F05                    syscall
   290                                 
   291 00000053 4883F800                cmp rax, 0
   292 00000057 0F8CE3000000            jl errorOnInputFile
   293                                 
   294 0000005D 49894500                mov qword[r13], rax
   295 00000061 48890425[00000000]      mov qword[rdFileDescriptor], rax
   296                                 
   297                                 
   298 00000069 498B5C2418              mov rbx, qword[r12+24]
   299 0000006E 66813B2D6F              cmp word[rbx], 0x6f2d
   300 00000073 0F85DF000000            jne invalidOutputSpecifier
   301                                 
   302                                 
   303 00000079 48C7C055000000          mov rax, SYS_creat
   304 00000080 498B7C2420              mov rdi, qword[r12+32]
   305 00000085 48C7C680010000          mov rsi, S_IRUSR | S_IWUSR
   306 0000008C 0F05                    syscall
   307                                 
   308 0000008E 4883F800                cmp rax, 0
   309 00000092 0F8CD5000000            jl errorOnOutputFile
   310                                 
   311 00000098 498906                  mov qword[r14], rax
   312                                 
   313 0000009B 48C7C002000000          mov rax, SYS_open
   314 000000A2 498B7C2420              mov rdi, qword[r12+32]
   315 000000A7 48C7C600000000          mov rsi, O_RDONLY
   316 000000AE 0F05                    syscall
   317                                 
   318 000000B0 4883F800                cmp rax, 0
   319 000000B4 0F8CB3000000            jl errorOnOutputFile
   320                                 
   321                                 
   322 000000BA 498B5C2428              mov rbx, qword[r12+40]
   323 000000BF 66813B2D64              cmp word[rbx], 0x642d
   324 000000C4 0F85B8000000            jne invalidDisplaySpecifier
   325                                 
   326                                 
   327 000000CA 498B5C2430              mov rbx, qword[r12+48]
   328                                 
   329                                 
   330 000000CF 803B54                  cmp byte[rbx], 0x54
   331 000000D2 0F84BF000000            je displayTrue
   332                                 
   333 000000D8 803B46                  cmp byte[rbx], 0x46
   334 000000DB 0F84D2000000            je displayFalse
   335                                 
   336                                 
   337                                 
   338 000000E1 E9EA000000              jmp invalidDisplayOption
   339                                 
   340                                 
   341                                  usage:
   342 000000E6 48C7C7[00000000]        mov rdi, usageMsg
   343 000000ED E8C5040000              call printString
   344 000000F2 48C7C000000000          mov rax, FALSE
   345 000000F9 E9E7000000              jmp argsDone
   346                                 
   347                                  many:
   348 000000FE 48C7C7[00000000]        mov rdi, errMany
   349 00000105 E8AD040000              call printString
   350 0000010A 48C7C000000000          mov rax, FALSE
   351 00000111 E9CF000000              jmp argsDone
   352                                 
   353                                  few:
   354 00000116 48C7C7[00000000]        mov rdi, errFew
   355 0000011D E895040000              call printString
   356 00000122 48C7C000000000          mov rax, FALSE
   357 00000129 E9B7000000              jmp argsDone
   358                                 
   359                                  invalidInputSpecifier:
   360 0000012E 48C7C7[00000000]        mov rdi, errISpec
   361 00000135 E87D040000              call printString
   362 0000013A 48C7C000000000          mov rax, FALSE
   363 00000141 E99F000000              jmp argsDone
   364                                 
   365                                  errorOnInputFile:
   366 00000146 48C7C7[00000000]        mov rdi, errOpenIn
   367 0000014D E865040000              call printString
   368 00000152 48C7C000000000          mov rax, FALSE
   369 00000159 E987000000              jmp argsDone
   370                                 
   371                                  invalidOutputSpecifier:
   372 0000015E 48C7C7[00000000]        mov rdi, errOSpec
   373 00000165 E84D040000              call printString
   374 0000016A 48C7C000000000          mov rax, FALSE
   375 00000171 EB75                    jmp argsDone
   376                                 
   377                                  errorOnOutputFile:
   378 00000173 48C7C7[00000000]        mov rdi, errOpenOut
   379 0000017A E838040000              call printString
   380 0000017F 48C7C000000000          mov rax, FALSE
   381 00000186 EB60                    jmp argsDone
   382                                 
   383                                  invalidDisplaySpecifier:
   384 00000188 48C7C7[00000000]        mov rdi, errDSpec
   385 0000018F E823040000              call printString
   386 00000194 48C7C000000000          mov rax, FALSE
   387 0000019B EB4B                    jmp argsDone
   388                                 
   389                                  displayTrue:
   390 0000019D 49C70001000000          mov qword[r8], TRUE
   391 000001A4 48C7C001000000          mov rax, TRUE
   392 000001AB 488B1C25[00000000]      mov rbx, qword[rdFileDescriptor]
   393 000001B3 49895D00                mov qword[r13], rbx
   394 000001B7 EB2F                    jmp argsDone
   395                                 
   396                                  displayFalse:
   397 000001B9 49C70000000000          mov qword[r8], FALSE
   398 000001C0 488B1C25[00000000]      mov rbx, qword[rdFileDescriptor]
   399 000001C8 49895D00                mov qword[r13], rbx
   400 000001CC 48C7C001000000          mov rax, TRUE
   401 000001D3 EB13                    jmp argsDone
   402                                 
   403                                  invalidDisplayOption:
   404 000001D5 48C7C7[00000000]        mov rdi, errTF
   405 000001DC E8D6030000              call printString
   406 000001E1 48C7C000000000          mov rax, FALSE
   407 000001E8 EBFE                    jmp argsDone
   408                                 
   409                                  argsDone:
   410                                 
   411 000001EA 415E                    pop r14
   412 000001EC 415D                    pop r13
   413 000001EE 415C                    pop r12
   414 000001F0 5B                      pop rbx
   415 000001F1 C3                     ret
   416                                 
   417                                 
   418                                 
   419                                 
   420                                 
   421                                 
   422                                 
   423                                 
   424                                 
   425                                 
   426                                 
   427                                 
   428                                 
   429                                 
   430                                 
   431                                 
   432                                 
   433                                 
   434                                 
   435                                 
   436                                 
   437                                 
   438                                 
   439                                 
   440                                 
   441                                 
   442                                 
   443                                 [global int2octal]
   444                                 int2octal:
   445                                 
   446 000001F2 4154                    push r12
   447 000001F4 4155                    push r13
   448                                 
   449 000001F6 49C7C408000000          mov r12, 8
   450 000001FD 48C7C100000000          mov rcx, 0
   451 00000204 4989F5                  mov r13, rsi
   452                                 
   453                                 
   454 00000207 4889F8                  mov rax, rdi
   455                                 
   456                                  convertLp:
   457 0000020A 48C7C200000000          mov rdx, 0
   458 00000211 49F7F4                  div r12
   459                                 
   460 00000214 52                      push rdx
   461 00000215 48FFC1                  inc rcx
   462                                 
   463                                 
   464 00000218 4883F800                cmp rax, 0
   465 0000021C 7400                    je cvtPushDone
   466                                 
   467 0000021E EBE8                    jmp convertLp
   468                                 
   469                                  cvtPushDone:
   470                                 
   471                                 
   472 00000220 48C7C200000000          mov rdx, 0
   473                                  popLp:
   474                                 
   475 00000227 415C                    pop r12
   476 00000229 48FFC9                  dec rcx
   477 0000022C 4983C430                add r12, "0"
   478 00000230 4588641500              mov byte[r13+rdx], r12b
   479                                 
   480 00000235 48FFC2                  inc rdx
   481                                 
   482 00000238 4883F900                cmp rcx, 0
   483 0000023C 7400                    je convertDone
   484 0000023E EBE5                    jmp popLp
   485                                 
   486                                  convertDone:
   487                                 
   488                                 
   489 00000240 48C7C001000000          mov rax, TRUE
   490                                 
   491 00000247 48C7C7[00000000]        mov rdi, tStr1
   492 0000024E E864030000              call printString
   493                                 
   494 00000253 415D                    pop r13
   495 00000255 415C                    pop r12
   496                                 
   497 00000257 C3                     ret
   498                                 
   499                                 
   500                                 
   501                                 
   502                                 
   503                                 
   504                                 
   505                                 
   506                                 
   507                                 
   508                                 
   509                                 
   510                                 
   511                                 
   512                                 
   513                                 
   514                                 
   515                                 
   516                                 
   517                                 
   518                                 
   519                                 
   520                                 [global countDigits]
   521                                 countDigits:
   522                                 
   523 00000258 4154                    push r12
   524 0000025A 4155                    push r13
   525                                 
   526 0000025C 4989FC                  mov r12, rdi
   527 0000025F 4989F5                  mov r13, rsi
   528                                 
   529                                  mainLp:
   530                                 
   531 00000262 488B3C25[00000000]      mov rdi, qword[curr]
   532 0000026A 488B3425[00000000]      mov rsi, qword[bfMax]
   533                                 
   534 00000272 4839F7                  cmp rdi, rsi
   535 00000275 7C5D                    jl endMainLp
   536                                 
   537 00000277 803C25[00000000]01      cmp byte[wasEOF], TRUE
   538 0000027F 0F8446010000            je exitCount
   539                                 
   540                                 
   541                                 
   542 00000285 48C7C000000000          mov rax, SYS_read
   543 0000028C 4C89E7                  mov rdi, r12
   544 0000028F 48C7C6[00000000]        mov rsi, buff
   545 00000296 48C7C220A10700          mov rdx, BUFFSIZE
   546 0000029D 0F05                    syscall
   547                                 
   548                                 
   549                                 
   550 0000029F 4883F800                cmp rax, 0
   551 000002A3 0F8C14010000            jl errOnRead
   552                                 
   553                                 
   554 000002A9 83F800                  cmp eax, 0
   555 000002AC 0F8419010000            je exitCount
   556                                 
   557                                 
   558 000002B2 3D20A10700              cmp eax, BUFFSIZE
   559 000002B7 7C00                    jl reachedEndOfFile
   560                                 
   561 000002B9 EB0D                    jmp notEndOfFile
   562                                 
   563                                  reachedEndOfFile:
   564                                 
   565                                 
   566 000002BB C60425[00000000]01      mov byte[wasEOF], TRUE
   567 000002C3 890425[00000000]        mov dword[bfMax], eax
   568                                 
   569                                  notEndOfFile:
   570                                 
   571                                 
   572                                 
   573 000002CA 48C70425[00000000]-     mov qword[curr], 0
   574 000002CA 00000000           
   575                                 
   576                                 
   577                                  endMainLp:
   578                                 
   579                                 
   580                                 
   581 000002D6 488B3425[00000000]      mov rsi, qword[curr]
   582 000002DE 8A96[00000000]          mov dl, byte[buff+rsi]
   583 000002E4 881425[00000000]        mov byte[chr], dl
   584                                 
   585                                 
   586                                 
   587                                 
   588 000002EB 833C25[00000000]05      cmp dword[skipLineCount], SKIP_LINES
   589 000002F3 7D1C                    jge skipLineDone
   590                                 
   591 000002F5 803C25[00000000]0A      cmp byte[chr], LF
   592 000002FD 7505                    jne noLineCnt
   593 000002FF FF0425[00000000]        inc dword[skipLineCount]
   594                                  noLineCnt:
   595                                 
   596                                 
   597 00000306 48FF0425[00000000]      inc qword[curr]
   598                                 
   599 0000030E E94AFFFFFF              jmp mainLp
   600                                 
   601                                  skipLineDone:
   602                                 
   603                                 
   604                                 
   605 00000313 833C25[00000000]06      cmp dword[skipCharCount], SKIP_CHARS
   606 0000031B 7F12                    jg skipCharDone
   607                                 
   608                                 
   609                                 
   610 0000031D FF0425[00000000]        inc dword[skipCharCount]
   611                                 
   612                                 
   613 00000324 48FF0425[00000000]      inc qword[curr]
   614                                 
   615                                 
   616 0000032C E92CFFFFFF              jmp mainLp
   617                                 
   618                                  skipCharDone:
   619                                 
   620                                 
   621 00000331 803C25[00000000]20      cmp byte[chr], 0x20
   622 00000339 750B                    jne skipSpace
   623                                 
   624                                 
   625 0000033B 48FF0425[00000000]      inc qword[curr]
   626 00000343 E915FFFFFF              jmp mainLp
   627                                 
   628                                  skipSpace:
   629                                 
   630                                 
   631 00000348 803C25[00000000]01      cmp byte[gotDigit], TRUE
   632 00000350 7438                    je notFirstDigit
   633                                 
   634                                 
   635 00000352 48C7C000000000          mov rax, 0
   636 00000359 8A0425[00000000]        mov al, byte[chr]
   637 00000360 2C30                    sub al, "0"
   638 00000362 880425[00000000]        mov byte[fDigit], al
   639                                 
   640                                 
   641 00000369 418344850001            add dword[r13+rax*4], 1
   642                                 
   643 0000036F 48FF0425[00000000]      inc qword[curr]
   644 00000377 48FF0425[00000000]      inc qword[totalCnt]
   645                                 
   646                                 
   647 0000037F C60425[00000000]01      mov byte[gotDigit], TRUE
   648 00000387 E9D1FEFFFF              jmp mainLp
   649                                 
   650                                  notFirstDigit:
   651                                 
   652                                 
   653 0000038C 803C25[00000000]0A      cmp byte[chr], LF
   654 00000394 751E                    jne notNewLine
   655                                 
   656 00000396 C70425[00000000]00-     mov dword[skipCharCount], 0
   657 00000396 000000             
   658                                 
   659                                 
   660 000003A1 C60425[00000000]00      mov byte[gotDigit], FALSE
   661                                 
   662 000003A9 48FF0425[00000000]      inc qword[curr]
   663 000003B1 E9A7FEFFFF              jmp mainLp
   664                                 
   665                                  notNewLine:
   666                                 
   667                                 
   668 000003B6 48FF0425[00000000]      inc qword[curr]
   669 000003BE E99AFEFFFF              jmp mainLp
   670                                 
   671                                  errOnRead:
   672                                 
   673 000003C3 48C7C7[00000000]        mov rdi, errFileRead
   674 000003CA E8E8010000              call printString
   675 000003CF EBFE                    jmp exitCount
   676                                 
   677                                  exitCount:
   678                                 
   679                                 
   680 000003D1 415D                    pop r13
   681 000003D3 415C                    pop r12
   682                                 
   683                                 
   684 000003D5 C3                     ret
   685                                 
   686                                 
   687                                 
   688                                 
   689                                 
   690                                 
   691                                 
   692                                 
   693                                 
   694                                 
   695                                 
   696                                 
   697                                 
   698                                 
   699                                 
   700                                 
   701                                 
   702                                 
   703                                 [global showGraph]
   704                                 showGraph:
   705                                 
   706                                 
   707 000003D6 4154                    push r12
   708 000003D8 4155                    push r13
   709 000003DA 4156                    push r14
   710                                 
   711 000003DC 4989FC                  mov r12, rdi
   712 000003DF 4989F5                  mov r13, rsi
   713 000003E2 4989D6                  mov r14, rdx
   714                                 
   715                                 
   716                                 
   717                                 
   718 000003E5 488B0425[00000000]      mov rax, qword[totalCnt]
   719 000003ED 483DA0860100            cmp rax, 100000
   720 000003F3 7C10                    jl scaleOne
   721                                 
   722 000003F5 483D20A10700            cmp rax, 500000
   723 000003FB 7C15                    jl scaleTwo
   724                                 
   725 000003FD 483D40420F00            cmp rax, 1000000
   726 00000403 7C1A                    jl scaleThree
   727                                 
   728 00000405 EB25                    jmp scaleFour
   729                                 
   730                                  scaleOne:
   731 00000407 C70425[00000000]64-     mov dword[scale], SCALE1
   732 00000407 000000             
   733 00000412 EB25                    jmp scaleDone
   734                                 
   735                                  scaleTwo:
   736 00000414 C70425[00000000]E8-     mov dword[scale], SCALE2
   737 00000414 030000             
   738 0000041F EB18                    jmp scaleDone
   739                                 
   740                                  scaleThree:
   741 00000421 C70425[00000000]C4-     mov dword[scale], SCALE3
   742 00000421 090000             
   743 0000042C EB0B                    jmp scaleDone
   744                                 
   745                                  scaleFour:
   746 0000042E C70425[00000000]88-     mov dword[scale], SCALE4
   747 0000042E 130000             
   748 00000439 EBFE                    jmp scaleDone
   749                                 
   750                                  scaleDone:
   751                                 
   752                                 
   753                                 
   754 0000043B 4C89E7                  mov rdi, r12
   755 0000043E 48C7C6[00000000]        mov rsi, graphHeader
   756 00000445 E81E010000              call writeString
   757                                 
   758                                 
   759                                 
   760 0000044A 488B3C25[00000000]      mov rdi, qword[totalCnt]
   761 00000452 48C7C6[00000000]        mov rsi, tStr1
   762 00000459 E88FFDFFFF              call int2octal
   763                                 
   764                                 
   765                                 
   766 0000045E 4C89E7                  mov rdi, r12
   767 00000461 48C7C6[00000000]        mov rsi, graphLine1
   768 00000468 E8FB000000              call writeString
   769                                 
   770                                 
   771                                 
   772 0000046D 48C7C600000000          mov rsi, 0
   773                                  clearNumTwo:
   774 00000474 C686[00000000]20        mov byte[num2+rsi], 0x20
   775 0000047B 48FFC6                  inc rsi
   776 0000047E 4883FE0A                cmp rsi, 10
   777 00000482 75EE                    jne clearNumTwo
   778                                 
   779                                 
   780                                 
   781 00000484 49C7C200000000          mov r10, 0
   782 0000048B 49C7C100000000          mov r9, 0
   783 00000492 49C7C030000000          mov r8, "0"
   784 00000499 48C7C700000000          mov rdi, 0
   785                                  graphLp:
   786                                 
   787 000004A0 44880425[00000000]      mov byte[index2], r8b
   788                                 
   789 000004A8 478B4C9500              mov r9d, dword[r13+r10*4]
   790 000004AD 44890C25[00000000]      mov dword[currCount], r9d
   791                                 
   792                                 
   793 000004B5 8B3C25[00000000]        mov edi, dword[currCount]
   794 000004BC 48C7C6[00000000]        mov rsi, num2
   795 000004C3 E825FDFFFF              call int2octal
   796                                 
   797                                 
   798 000004C8 8B0425[00000000]        mov eax, dword[currCount]
   799 000004CF 99                      cdq
   800 000004D0 F73425[00000000]        div dword[scale]
   801 000004D7 83F800                  cmp eax, 0
   802 000004DA 741F                    je zeroStars
   803 000004DC 890425[00000000]        mov dword[starCount], eax
   804                                 
   805                                 
   806 000004E3 48C7C600000000          mov rsi, 0
   807                                  starLp:
   808                                 
   809 000004EA C686[00000000]2A        mov byte[stars2+rsi], "*"
   810 000004F1 48FFC6                  inc rsi
   811 000004F4 3B3425[00000000]        cmp esi, dword[starCount]
   812 000004FB 75EB                    jne starLp
   813                                 
   814                                 
   815                                  zeroStars:
   816                                 
   817 000004FD 4C89E7                  mov rdi, r12
   818 00000500 48C7C6[00000000]        mov rsi, graphLine2
   819 00000507 E85C000000              call writeString
   820                                 
   821                                 
   822 0000050C 48C7C600000000          mov rsi, 0
   823 00000513 833C25[00000000]00      cmp dword[starCount], 0
   824 0000051B 7411                    je noStars
   825                                 
   826                                  clearStar:
   827 0000051D C686[00000000]20        mov byte[stars2+rsi], 0x20
   828 00000524 48FFC6                  inc rsi
   829 00000527 3B3425[00000000]        cmp esi, dword[starCount]
   830 0000052E 75EB                    jne clearStar
   831                                 
   832                                 
   833                                  noStars:
   834                                 
   835                                 
   836 00000530 48C7C600000000          mov rsi, 0
   837                                  clearNum2:
   838 00000537 C686[00000000]20        mov byte[num2+rsi], 0x20
   839 0000053E 48FFC6                  inc rsi
   840 00000541 4883FE07                cmp rsi, 7
   841 00000545 75EE                    jne clearNum2
   842                                 
   843                                 
   844                                 
   845 00000547 49FFC0                  inc r8
   846 0000054A 49FFC2                  inc r10
   847 0000054D 4983FA0A                cmp r10, 10
   848 00000551 0F8543FFFFFF            jne graphLp
   849                                 
   850 00000557 4C89E7                  mov rdi, r12
   851 0000055A 48C7C6[00000000]        mov rsi, graphLine3
   852 00000561 E802000000              call writeString
   853                                 
   854                                 
   855 00000566 415E                    pop r14
   856 00000568 415D                    pop r13
   857 0000056A 415C                    pop r12
   858 0000056C C3                     ret
   859                                 
   860                                 
   861                                 
   862                                 
   863                                 
   864                                 
   865                                 
   866                                 
   867                                 
   868                                 
   869                                 
   870                                 
   871                                 
   872                                 
   873                                 
   874                                 
   875                                 
   876                                 
   877                                 
   878                                 
   879                                 [global writeString]
   880                                 writeString:
   881                                 
   882 0000056D 4154                    push r12
   883 0000056F 4155                    push r13
   884 00000571 4156                    push r14
   885                                 
   886 00000573 4989FC                  mov r12, rdi
   887 00000576 4989F5                  mov r13, rsi
   888                                 
   889                                 
   890 00000579 49C7C600000000          mov r14, 0
   891                                 
   892                                 
   893                                  countChar:
   894                                 
   895 00000580 803E00                  cmp byte[rsi], NULL
   896 00000583 7406                    je charCountDone
   897 00000585 49FFC6                  inc r14
   898 00000588 48FFC6                  inc rsi
   899 0000058B EBF1                    jmp countChar
   900                                  charCountDone:
   901                                 
   902                                 
   903 0000058D 48C7C001000000          mov rax, SYS_write
   904 00000594 4C89E7                  mov rdi, r12
   905 00000597 4C89EE                  mov rsi, r13
   906 0000059A 4C89F2                  mov rdx, r14
   907 0000059D 0F05                    syscall
   908                                 
   909 0000059F 4883F800                cmp rax, 0
   910 000005A3 7C00                    jl errorOnWrite
   911                                 
   912 000005A5 EB0C                    jmp endWrite
   913                                 
   914                                  errorOnWrite:
   915                                 
   916 000005A7 48C7C7[00000000]        mov rdi, errFileWrite
   917 000005AE E804000000              call printString
   918 000005B3 EBFE                    jmp endWrite
   919                                 
   920                                  endWrite:
   921                                 
   922 000005B5 415E                    pop r14
   923 000005B7 415D                    pop r13
   924 000005B9 415C                    pop r12
   925 000005BB C3                     ret
   926                                 
   927                                 
   928                                 
   929                                 
   930                                 
   931                                 
   932                                 
   933                                 
   934                                 
   935                                 
   936                                 
   937                                 
   938                                 
   939                                 
   940                                 
   941                                 
   942                                 
   943                                 
   944                                 
   945                                 
   946                                 
   947                                 [global printString]
   948                                 printString:
   949                                 
   950                                 
   951                                 
   952                                 
   953 000005BC 48C7C200000000          mov rdx, 0
   954                                 strCountLoop:
   955 000005C3 803C1700                cmp byte [rdi+rdx], NULL
   956 000005C7 7403                    je strCountLoopDone
   957 000005C9 48FFC2                  inc rdx
   958 000005CC EBF3                    jmp strCountLoop
   959                                 strCountLoopDone:
   960 000005CE 4883FA00                cmp rdx, 0
   961 000005D2 7411                    je printStringDone
   962                                 
   963                                 
   964                                 
   965                                 
   966 000005D4 48C7C001000000          mov rax, SYS_write
   967 000005DB 4889FE                  mov rsi, rdi
   968 000005DE 48C7C701000000          mov rdi, STDOUT
   969                                 
   970 000005E5 0F05                    syscall
   971                                 
   972                                 
   973                                 
   974                                 
   975                                 printStringDone:
   976 000005E7 C3                      ret
   977                                 
   978                                 
   979                                 
