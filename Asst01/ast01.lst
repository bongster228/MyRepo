     1                                 %line 1+1 ast01.asm
     2                                 
     3                                 
     4                                 %line 19+1 ast01.asm
     5                                 
     6                                 %line 92+1 ast01.asm
     7                                 
     8                                 
     9                                 
    10                                 
    11                                 
    12                                 
    13                                 
    14                                 [section .data]
    15                                 
    16                                 
    17                                 
    18                                 
    19                                 LF equ 10
    20                                 NULL equ 0
    21                                 
    22                                 
    23                                 TRUE equ 1
    24                                 FALSE equ 0
    25                                 
    26                                 EXIT_SUCCESS equ 0
    27                                 
    28                                 STDIN equ 0
    29                                 STDOUT equ 1
    30                                 STDERR equ 2
    31                                 
    32                                 SYS_read equ 0
    33                                 SYS_write equ 1
    34                                 SYS_open equ 2
    35                                 SYS_close equ 3
    36                                 SYS_fork equ 57
    37                                 SYS_exit equ 60
    38                                 SYS_creat equ 85
    39                                 SYS_time equ 201
    40                                 
    41                                 
    42                                 
    43 00000000 48656C6C6F20576F72-    message1 db "Hello World", LF, NULL
    44 00000000 6C640A00           
    45 0000000D 456E74657220416E73-    message2 db "Enter Answer: ", NULL
    46 0000000D 7765723A2000       
    47 0000001C 0A00                   newLine db LF, NULL
    48                                 
    49 0000001E 00                     inChar db 0
    50                                 STRLEN equ 50
    51 0000001F 456E74657220546578-    pmpt db "Enter Text: ", NULL
    52 0000001F 743A2000           
    53                                 
    54                                 
    55                                 
    56                                 
    57                                 
    58                                 
    59                                 
    60 0000002C 00000000                n1 dd 0
    61 00000030 0000                    n2w dw 0
    62 00000032 00000000                n3 dd 0
    63                                 
    64 00000036 00000000                res1 dd 0
    65 0000003A 00000000                res2 dd 0
    66 0000003E 00000000                res3 dd 0
    67 00000042 00000000                rem3 dd 0
    68                                 
    69                                 
    70                                 
    71 00000046 010002000300040005-     wLst dw 1, 2, 3, 4, 5, 6, 7, 8, 9, 10
    72 00000046 000600070008000900-
    73 00000046 0A00               
    74 0000005A 010000000200000003-     arr dd 1,2,3,4,5,6,7,8,10
    75 0000005A 000000040000000500-
    76 0000005A 000006000000070000-
    77 0000005A 00080000000A000000 
    78 0000007E 0A000000                len dd 10
    79 00000082 00000000                min dd 0
    80 00000086 00000000                med1 dd 0
    81 0000008A 00000000                med2 dd 0
    82 0000008E 00000000                max dd 0
    83 00000092 00000000                sum dd 0
    84 00000096 00000000                ave dd 0
    85                                 
    86 0000009A 00000000                sqVal dd 0
    87                                 
    88                                 [section .bss]
    89                                 
    90 00000000 <gap>                   dLst resd 10
    91 00000028 <gap>                   chr resb 1
    92 00000029 <gap>                   inLine resb STRLEN+2
    93                                 
    94                                 
    95                                 
    96                                 
    97                                 [section .text]
    98                                 
    99                                 [global _stats1]
   100                                 stats1:
   101 00000000 4154                    push r12
   102                                 
   103 00000002 49C7C400000000          mov r12, 0
   104 00000009 48C7C000000000          mov rax, 0
   105                                 sumLoop:
   106 00000010 420304A7                add eax, dword[rdi+r12*4]
   107 00000014 49FFC4                  inc r12
   108 00000017 4939F4                  cmp r12, rsi
   109 0000001A 7CF2                    jl sumLoop
   110                                 
   111 0000001C 8902                    mov dword[rdx], eax
   112                                 
   113 0000001E 99                      cdq
   114 0000001F F7FE                    idiv esi
   115 00000021 8901                    mov dword[rcx], eax
   116                                 
   117 00000023 415C                    pop r12
   118 00000025 C3                      ret
   119                                 
   120                                 [global _stats2]
   121                                 
   122                                 stats2:
   123 00000026 55                      push rbp
   124 00000027 4889E5                  mov rbp, rsp
   125 0000002A 4154                    push r12
   126                                 
   127                                 
   128 0000002C 8B07                    mov eax, dword[rdi]
   129 0000002E 8902                    mov dword[rdx], eax
   130                                 
   131 00000030 4989F4                  mov r12, rsi
   132 00000033 49FFCC                  dec r12
   133 00000036 428B04A7                mov eax, dword[rdi+r12*4]
   134 0000003A 418901                  mov dword[r9], eax
   135                                 
   136                                 
   137 0000003D 4889F0                  mov rax, rsi
   138 00000040 48C7C200000000          mov rdx, 0
   139 00000047 49C7C402000000          mov r12, 2
   140 0000004E 49F7F4                  div r12
   141                                 
   142 00000051 4883FA00                cmp rdx, 0
   143 00000055 740A                    je evenLength
   144                                 
   145 00000057 448B2487                mov r12d, dword[rdi+rax*4]
   146 0000005B 448921                  mov dword[rcx], r12d
   147 0000005E 458920                  mov dword[r8], r12d
   148 00000061 EB0F                    jmp medDone
   149                                 
   150                                 evenLength:
   151 00000063 448B2487                mov r12d, dword[rdi+rax*4]
   152 00000067 458920                  mov dword[r8], r12d
   153 0000006A 48FFC8                  dec rax
   154 0000006D 448B2487                mov r12d, dword[rdi+rax*4]
   155 00000071 448921                  mov dword[rcx], r12d
   156                                 medDone:
   157                                 
   158                                 
   159 00000074 49C7C400000000          mov r12, 0
   160 0000007B 48C7C000000000          mov rax, 0
   161                                 
   162                                 sumLoop2:
   163 00000082 420304A7                add eax, dword[rdi+r12*4]
   164 00000086 49FFC4                  inc r12
   165 00000089 4939F4                  cmp r12, rsi
   166 0000008C 7CF2                    jl sumLoop2
   167                                 
   168 0000008E 4C8B6510                mov r12, qword[rbp+16]
   169 00000092 41890424                mov dword[r12], eax
   170                                 
   171                                 
   172 00000096 99                      cdq
   173 00000097 48F7FE                  idiv rsi
   174 0000009A 4C8B6518                mov r12, qword[rbp+24]
   175 0000009E 41890424                mov dword[r12], eax
   176                                 
   177 000000A2 415C                    pop r12
   178 000000A4 5D                      pop rbp
   179 000000A5 C3                      ret
   180                                 
   181                                 
   182                                 
   183                                 
   184                                 
   185                                 
   186                                 
   187                                 [global printString]
   188                                 printString:
   189                                 
   190 000000A6 53                      push rbx
   191                                 
   192 000000A7 4889FB                  mov rbx, rdi
   193 000000AA 48C7C200000000          mov rdx, 0
   194                                 
   195                                 strCountLoop:
   196 000000B1 803B00                  cmp byte[rbx], NULL
   197 000000B4 7406                    je strCountDone
   198 000000B6 48FFC2                  inc rdx
   199 000000B9 48FFC3                  inc rbx
   200 000000BC EBF1                    jmp strCountLoop
   201                                 strCountDone:
   202                                 
   203 000000BE 4883FA00                cmp rdx, 0
   204 000000C2 7411                    je prtDone
   205                                 
   206                                 
   207                                 
   208 000000C4 48C7C001000000          mov rax, SYS_write
   209 000000CB 4889FE                  mov rsi, rdi
   210 000000CE 48C7C701000000          mov rdi, STDOUT
   211 000000D5 0F05                    syscall
   212                                 
   213                                 
   214                                 
   215                                  prtDone:
   216 000000D7 5B                      pop rbx
   217 000000D8 C3                      ret
   218                                 
   219                                 [global _start]
   220                                 _start:
   221                                 
   222                                 
   223                                 
   224 000000D9 68[00000000]            push ave
   225 000000DE 68[00000000]            push sum
   226 000000E3 49C7C1[00000000]        mov r9, max
   227 000000EA 49C7C0[00000000]        mov r8, med2
   228 000000F1 48C7C1[00000000]        mov rcx, med1
   229 000000F8 48C7C2[00000000]        mov rdx, min
   230 000000FF 8B3425[00000000]        mov esi, dword[len]
   231 00000106 48C7C7[00000000]        mov rdi, arr
   232                                 
   233 0000010D E80FFFFFFF              call stats2
   234 00000112 4883C410                add rsp, 16
   235                                 
   236                                 
   237                                 
   238 00000116 48C7C7[00000000]        mov rdi, message1
   239 0000011D E87FFFFFFF              call printString
   240                                 
   241 00000122 48C7C7[00000000]        mov rdi, message2
   242 00000129 E873FFFFFF              call printString
   243                                 
   244 0000012E 48C7C7[00000000]        mov rdi, newLine
   245 00000135 E867FFFFFF              call printString
   246                                 
   247                                 
   248                                 
   249                                 
   250                                 
   251 0000013A 48C7C7[00000000]        mov rdi, pmpt
   252 00000141 E85BFFFFFF              call printString
   253                                 
   254                                 
   255                                 
   256                                 
   257 00000146 48C7C3[00000000]        mov rbx, inLine
   258 0000014D 49C7C400000000          mov r12, 0
   259                                 
   260                                 readCharacters:
   261 00000154 48C7C000000000          mov rax, SYS_read
   262 0000015B 48C7C700000000          mov rdi, STDIN
   263 00000162 488D3425[00000000]      lea rsi, byte[chr]
   264 0000016A 48C7C201000000          mov rdx, 1
   265 00000171 0F05                    syscall
   266                                 
   267 00000173 8A0425[00000000]        mov al, byte[chr]
   268 0000017A 3C0A                    cmp al, LF
   269 0000017C 740E                    je readDone
   270                                 
   271 0000017E 49FFC4                  inc r12
   272 00000181 4983FC32                cmp r12, STRLEN
   273 00000185 73CB                    jae readCharacters
   274                                 
   275 00000187 8803                    mov byte[rbx], al
   276 00000189 48FFC3                  inc rbx
   277                                 
   278 0000018C EBC4                    jmp readCharacters
   279                                 readDone:
   280 0000018E C60300                  mov byte[rbx], NULL
   281                                 
   282 00000191 48C7C7[00000000]        mov rdi, inLine
   283 00000198 E804FFFFFF              call printString
   284                                 
   285 0000019D 48C7C7[00000000]        mov rdi, newLine
   286 000001A4 E8F8FEFFFF              call printString
   287                                 
   288                                 
   289                                 
   290                                 
   291                                 
   292                                 
   293                                 
   294                                 
   295                                 
   296                                 
   297                                 
   298                                 
   299                                 
   300                                 last:
   301 000001A9 48C7C03C000000          mov rax, SYS_exit
   302 000001B0 48C7C700000000          mov rdi, EXIT_SUCCESS
   303 000001B7 0F05                    syscall
   304                                 
